#!/bin/bash

path="$1"

sed -i.bak 's/<pre><code class="no-highlight">/```\n/' "$path"
sed -i.bak 's/<pre><code class="ruby">/```ruby\n/' "$path"
sed -i.bak 's/<pre><code class="html">/```html\n/' "$path"
sed -i.bak 's/<pre><code class="sql">/```sql\n/' "$path"
sed -i.bak 's/<pre><code class="php">/```php\n/' "$path"
sed -i.bak 's/<pre><code class="bash">/```bash\n/' "$path"
sed -i.bak 's/<pre><code class="sh">/```sh\n/' "$path"
sed -i.bak 's/<pre><code class="language-bash">/```bash\n/' "$path"
sed -i.bak 's/<pre><code class="language-ruby">/```ruby\n/' "$path"
sed -i.bak 's/<pre><code class="language-haml">/```haml\n/' "$path"
sed -i.bak 's/<pre><code class="language-html">/```html\n/' "$path"
sed -i.bak 's/<pre><code class="language-sql">/```sql\n/' "$path"
sed -i.bak 's/<pre><code class="language-css">/```css\n/' "$path"
sed -i.bak 's/<pre><code class="language-irb">/```irb\n/' "$path"
sed -i.bak 's/^<\/code><\/pre>/```/' "$path"
sed -i.bak "s/<\\/code><\\/pre>/\n\`\`\`/" "$path"
sed -i.bak 's/&lt;/</g' "$path"
sed -i.bak 's/&gt;/>/g' "$path"
sed -i.bak "s/\r//" "$path"

rm "$path.bak"
